(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["ScheduledMessages"],{"020b":function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Block",{staticClass:"card-base block custom-box-shadow"},[e._t("default")],2)},n=[],i=a("0814"),r={name:"CardBase",components:{Block:i["a"]}},o=r,l=a("2877"),c=Object(l["a"])(o,s,n,!1,null,"64f32f13",null);t["a"]=c.exports},"0af5":function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("InputBase",{attrs:{title:e.title,required:e.required,info:e.info,error:e.error},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.id,n=t.isInvalid;return[a("select",{ref:"input",staticClass:"form-control",class:{"is-invalid":n},attrs:{id:s,required:e.required,placeholder:e.placeholder,disabled:e.disabled},domProps:{value:e.value},on:{input:e.updateInput}},e._l(e.options,(function(t,s){return a("option",{key:s,attrs:{disabled:t.disabled,hidden:t.hidden},domProps:{selected:t.selected,value:e.getOptionValue(t)}},[e._v(" "+e._s(e.getOptionText(t))+" ")])})),0)]}}])})},n=[],i=(a("a9e3"),a("850b")),r={name:"InputSelect",components:{InputBase:i["a"]},props:{title:{type:String,default:""},options:{type:Array,default:function(){return[]}},required:{type:Boolean,default:!1},value:{type:[String,Object,Number,Boolean],default:null},optionValue:{type:String,default:""},optionText:{type:String,default:""},error:{type:String,default:""},placeholder:{type:String,default:""},info:{type:String,default:""},disabled:{type:Boolean}},methods:{updateInput:function(){this.$emit("input",this.$refs.input.value),this.$emit("select",this.$refs.input.value)},getOptionValue:function(e){return this.optionValue?e[this.optionValue]:e},getOptionText:function(e){return this.optionText?e[this.optionText]:e}}},o=r,l=a("2877"),c=Object(l["a"])(o,s,n,!1,null,null,null);t["a"]=c.exports},"0f8e":function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("FlexBox",{staticClass:"flex-lg-row flex-wrap align-items-lg-center",attrs:{direction:"column-reverse",justify:"between","align-items":"end"}},[a("Block",{staticClass:"p-2"},[e._v(" "+e._s(e.pagination.message)+" ")]),a("FlexBox",{staticClass:"flex-lg-row flex-wrap align-items-lg-center",attrs:{direction:"column",justify:"between","align-items":"end"}},[a("InputSelect",{staticClass:"my-2 my-lg-0",attrs:{options:e.perPages},on:{select:function(t){return e.$emit("change")}},model:{value:e.pagination.perPage,callback:function(t){e.$set(e.pagination,"perPage",t)},expression:"pagination.perPage"}}),a("nav",{staticClass:"ml-3"},[a("ul",{staticClass:"pagination disable-user-select mb-0"},[a("li",{staticClass:"page-item",class:{disabled:!e.isPreviousable},on:{click:function(t){return t.preventDefault(),e.setCurrent(e.current-1)}}},[a("span",{staticClass:"page-link"},[e._v("Previous")])]),e._l(e.pages,(function(t,s){return a("li",{key:s,staticClass:"page-item",class:{active:e.current===t}},[a("a",{staticClass:"page-link btn-primary",attrs:{href:"#"},on:{click:function(a){return a.preventDefault(),e.setCurrent(t)}}},[e._v(e._s(t))])])})),a("li",{staticClass:"page-item",class:{disabled:!e.isNextable},on:{click:function(t){return t.preventDefault(),e.setCurrent(e.current+1)}}},[a("a",{staticClass:"page-link",attrs:{href:"#"}},[e._v("Next")])])],2)])],1)],1)},n=[],i=(a("a9e3"),a("2ef0")),r=a("9559"),o=a("0814"),l=a("0af5"),c={name:"Pagination",components:{InputSelect:l["a"],Block:o["a"],FlexBox:r["a"]},props:{visibleLength:{type:Number,default:5},pagination:{type:Object,default:function(){return{}}}},data:function(){return{offset:0,perPages:[5,15,25,50,100],pages:[]}},computed:{current:function(){return this.pagination.current||1},length:function(){return this.pagination.pages||1},isNextable:function(){return this.length>this.current},isPreviousable:function(){return this.current>1}},watch:{length:{handler:function(){this.unWatchCurrentPageValue();var e=this.visibleLength,t=Math.ceil(e/2)+(e%2?0:1);this.offset=e-(e-t+1),this.generatePagination(),this.length>this.visibleLength&&(this.unWatchCurrentPageValue=this.$watch("current",this.generatePagination))},immediate:!0}},methods:{unWatchCurrentPageValue:function(){},generatePagination:function(){var e=this.current,t=this.offset,a=this.length,s=this.visibleLength,n=e-t;n<1&&(n=1);var r=n+s;r>a&&(r=a+1,n=r-s,n<1&&(n=1)),this.pages=Object(i["range"])(n,r)},setCurrent:function(e){var t=e;e<=1?t=1:e>=this.length&&(t=this.length),t!==this.current&&this.$emit("change",t)}}},u=c,d=(a("5148"),a("2877")),p=Object(d["a"])(u,s,n,!1,null,"64c09d8e",null);t["a"]=p.exports},5148:function(e,t,a){"use strict";a("b994")},6062:function(e,t,a){"use strict";var s=a("6d61"),n=a("6566");e.exports=s("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),n)},"8c53":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Block",[a("CardBase",{staticClass:"p-4 mb-3"},[a("Row",[a("Block",{staticClass:"col-md-12"},[a("Search",{attrs:{debounce:500,placeholder:"Search message keywords"},on:{change:e.fetchData},model:{value:e.filters.keyword,callback:function(t){e.$set(e.filters,"keyword",t)},expression:"filters.keyword"}})],1)],1)],1),a("MessagesTable",{attrs:{messages:e.messages,pagination:e.pagination,"is-loading":e.isLoading},on:{reload:e.fetchData}})],1)},n=[],i=a("5530"),r=a("9ace"),o=a("3d8a"),l=a("7228"),c=a("020b"),u=a("27dc"),d=a("dd08"),p=a("0814"),f={name:"Scheduled",components:{Block:p["a"],MessagesTable:r["a"],Search:d["a"],Row:u["a"],CardBase:c["a"]},data:function(){return{messages:[],isLoading:!1,targetMessage:{},filters:{},pagination:{pages:1,current:1,perPage:15}}},computed:{dataFilters:function(){var e=this.filters,t=this.pagination;return Object(i["a"])(Object(i["a"])({},e),{},{page:t.current||null,per_page:t.perPage})}},created:function(){var e=this;this.$bus.on("reload-message-table",(function(t){e.targetMessage=t||{},e.fetchData()})),this.fetchData()},mounted:function(){var e=this;this.$bus.on("router-link-clicked",(function(){e.isLoading||e.fetchData()}))},beforeDestroy:function(){this.$bus.removeAllListeners("reload-message-table")},methods:{fetchData:function(){var e=this;this.isLoading=!0,Object(o["f"])(this.dataFilters).then((function(t){var a=t.data,s=t.meta;e.messages=a,e.pagination=Object(l["b"])(s),e.isLoading=!1})).catch((function(t){"request-cancel"!==t&&(e.$toast.error("There was an error while fetching data."),e.isLoading=!1)}))}}},h=f,g=a("2877"),m=Object(g["a"])(h,s,n,!1,null,"6df33d57",null);t["default"]=m.exports},"9ace":function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Block",{staticClass:"mb-4"},[a("DeleteMessage",{attrs:{visible:e.isDeleteModalShown,identifier:e.targetMessage.identifier},on:{success:e.onMessageDeleted,close:function(t){e.isDeleteModalShown=!1}}}),a("CardBase",{class:e.isLoading?"":"with-table"},[a("CardLoader",{attrs:{"is-loading":e.isLoading}},[a("Block",{staticClass:"table-responsive collapsible"},[e.messages.length?a("table",{staticClass:"table table-hover m-0"},[a("thead",{staticClass:"bg-gray-lighter"},[a("tr",[a("th",{staticClass:"text-center",staticStyle:{width:"40px"}},[e._v(" # ")]),a("th",{staticClass:"recipients"},[e._v(" Recipients ")]),a("th",{staticStyle:{width:"40%"}},[e._v(" Message ")]),"scheduled"===e.mode?a("th",{staticClass:"text-right px-4"},[e._v(" Scheduled for ")]):e._e(),a("th",{staticClass:"text-right px-4"},[e._v(" Created ")]),a("th",{staticStyle:{width:"150px"}})])]),a("tbody",e._l(e.messages,(function(t,s){return a("tr",{key:t.id,staticClass:"cursor-pointer",attrs:{title:"view message in detail"},on:{click:function(a){return e.onViewMessage(t.identifier)}}},[a("td",{staticClass:"text-center"},[a("span",{staticClass:"hidden-info"},[e._v("#")]),a("span",[e._v(e._s(s+1))])]),a("td",{staticClass:"recipients"},[a("span",{staticClass:"hidden-info"},[e._v("Recipients:")]),t.recipients?[1===t.recipients.length?a("span",{staticClass:"field-data"},[e._v(" "+e._s(t.recipients[0].receiver_name||t.recipients[0].to)+" ")]):2===t.recipients.length?a("span",{staticClass:"field-data"},[e._v(" "+e._s((t.recipients[0].receiver_name||t.recipients[0].to)+" and 1 other")+" ")]):a("span",{staticClass:"field-data"},[e._v(" "+e._s((t.recipients[0].receiver_name||t.recipients[0].to)+" and "+(t.recipients.length-1)+" others")+" ")])]:a("span",[e._v(" N/A")])],2),a("td",[a("span",{staticClass:"hidden-info"},[e._v("Message:")]),a("span",{staticClass:"message-body"},[e._v(e._s(t.body))])]),"scheduled"===e.mode?a("td",{staticClass:"text-right px-4"},[a("span",{staticClass:"hidden-info"},[e._v("Scheduled at:")]),a("span",[e._v(e._s(e.duration(t.scheduled_at,!1,!0)))])]):e._e(),a("td",{staticClass:"text-right px-4"},[a("span",{staticClass:"hidden-info"},[e._v("Created:")]),a("span",[e._v(e._s(e.duration(t.created_at)))])]),a("td",{staticClass:"pr-4"},[a("span",{staticClass:"hidden-info"}),a("FlexBox",{attrs:{"align-items":"center",justify:"end"}},[a("FlexBox",{attrs:{"align-items":"center",justify:"end"}},[a("Button",{staticClass:"view-button mr-2 p-2 d-none text-gray-800",attrs:{color:"secondary",title:"View message in detail"},on:{click:function(a){return e.onViewMessage(t.identifier)}}},[a("Icon",{attrs:{name:"file-text-o",size:"regular"}})],1),a("Button",{staticClass:"mr-2 p-2 text-gray-800",attrs:{color:"secondary",title:"compose a new message for all recipients"},on:{click:function(a){return e.onReply(t.recipients)}}},[a("Icon",{attrs:{type:"si",name:"envelope-letter",size:"regular"}})],1),a("Button",{staticClass:"mr-2 p-2 text-gray-800",attrs:{color:"secondary",title:"forward message"},on:{click:function(a){return e.onForward(t.body)}}},[a("Icon",{attrs:{name:"reply-all fa-flip-horizontal"}})],1),"scheduled"===e.mode?a("Button",{staticClass:"p-2 mx-1 text-danger",attrs:{color:"light",title:"delete message"},on:{click:function(a){return e.onDeleteMessage(t)}}},[a("Icon",{attrs:{type:"fa",name:"trash",size:"regular"}})],1):e._e()],1)],1)],1)])})),0)]):a("Block",{staticClass:"min-height-300 d-flex flex-row justify-content-center align-items-center"},[a("h4",{staticClass:"text-gray-dark font-w300"},[a("span",{staticClass:"text-capitalize"},[e._v(e._s(e.mode))]),e._v(" messages not found ")])])],1)],1)],1),a("Pagination",{staticClass:"my-2 my-lg-0",attrs:{pagination:e.pagination},on:{change:e.changePagination}})],1)},n=[],i=(a("99af"),a("a630"),a("d81d"),a("a9e3"),a("d3b7"),a("6062"),a("3ca3"),a("ddb0"),a("020b")),r=a("0f8e"),o=a("c2cd"),l=a("5d35"),c=a("ad4f"),u=a("9559"),d=a("f137"),p=a("0814"),f={name:"MessagesTable",components:{Block:p["a"],DeleteMessage:d["a"],FlexBox:u["a"],Button:c["a"],Icon:l["a"],CardBase:i["a"],Pagination:r["a"],CardLoader:o["a"]},props:{messages:{type:Array,default:function(){return[]}},mode:{type:String,default:"scheduled"},pagination:{type:Object,default:function(){return{}}},isLoading:{type:Boolean}},data:function(){return{targetMessage:{},isEditModalShown:!1,isDeleteModalShown:!1}},computed:{perPages:function(){var e=[5,15,25,50,100],t=this.$route.query.per_page;return"undefined"!==typeof t&&e.push(Number(t)),e=Array.from(new Set(e)),e.sort((function(e,t){return e-t}))}},methods:{onViewMessage:function(e){this.$router.push("/messages/".concat(this.mode,"/").concat(e))},onDeleteMessage:function(e){this.targetMessage=e,this.isDeleteModalShown=!0},onReply:function(e){this.$bus.emit("compose",{action:"New",recipients:e.map((function(e){return{name:e.receiver_name||e.to,phone:e.to}}))})},onForward:function(e){this.$bus.emit("compose",{action:"Forward",body:e})},onMessageDeleted:function(){this.$emit("reload"),this.isDeleteModalShown=!1},changePagination:function(e){this.pagination.current=e,this.$emit("reload")}}},h=f,g=a("2877"),m=Object(g["a"])(h,s,n,!1,null,null,null);t["a"]=m.exports},b994:function(e,t,a){},dd08:function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"input-group"},[a("input",{ref:"searchInp",staticClass:"form-control",attrs:{type:"search",placeholder:e.placeholder},domProps:{value:e.value},on:{input:e.setValue}}),e._m(0)])},n=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"input-group-append"},[a("span",{staticClass:"input-group-text"},[a("i",{staticClass:"fa fa-search"})])])}],i=(a("a9e3"),a("2ef0")),r={name:"Search",props:{placeholder:{type:String,default:"Search"},value:{type:String,default:""},debounce:{type:Number,default:0}},created:function(){this.debounce&&(this.onChange=Object(i["debounce"])(this.onChange,this.debounce))},methods:{setValue:function(){var e=this.$refs.searchInp.value;this.$emit("input",e),this.onChange(e)},onChange:function(e){this.$emit("change",e)}}},o=r,l=a("2877"),c=Object(l["a"])(o,s,n,!1,null,"6ec74c60",null);t["a"]=c.exports},f137:function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Modal",{attrs:{title:"Confirmation",visible:e.visible,loading:e.isLoading,"modal-style":"max-width: 400px;"},on:{close:e.close,success:e.deleteMessage}},[a("Block",{staticClass:"px-4"},[a("p",[e._v("Delete this scheduled message?")])])],1)},n=[],i=(a("d3b7"),a("78b5")),r=a("3d8a"),o=a("0814"),l={name:"DeleteMessage",components:{Block:o["a"],Modal:i["a"]},props:{visible:{type:Boolean,default:!1},identifier:{type:String,default:null}},data:function(){return{isLoading:!1}},methods:{deleteMessage:function(){var e=this;this.isLoading=!0,Object(r["d"])(this.identifier).then((function(){e.$toast.success("Message deleted successfully!"),e.$emit("success"),e.close()})).catch((function(t){var a=t||"Couldn't delete message.";e.$toast.error(a)})).finally((function(){e.isLoading=!1,e.close()}))},close:function(){this.isLoading||this.$emit("close")}}},c=l,u=a("2877"),d=Object(u["a"])(c,s,n,!1,null,null,null);t["a"]=d.exports}}]);