(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Balance"],{"020b":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Block",{staticClass:"card-base block custom-box-shadow"},[t._t("default")],2)},i=[],n=a("0814"),r={name:"CardBase",components:{Block:n["a"]}},l=r,o=a("2877"),c=Object(o["a"])(l,s,i,!1,null,"64f32f13",null);e["a"]=c.exports},"0af5":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("InputBase",{attrs:{title:t.title,required:t.required,info:t.info,error:t.error},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.id,i=e.isInvalid;return[a("select",{ref:"input",staticClass:"form-control",class:{"is-invalid":i},attrs:{id:s,required:t.required,placeholder:t.placeholder,disabled:t.disabled},domProps:{value:t.value},on:{input:t.updateInput}},t._l(t.options,(function(e,s){return a("option",{key:s,attrs:{disabled:e.disabled,hidden:e.hidden},domProps:{selected:e.selected,value:t.getOptionValue(e)}},[t._v(" "+t._s(t.getOptionText(e))+" ")])})),0)]}}])})},i=[],n=a("850b"),r={name:"InputSelect",components:{InputBase:n["a"]},props:{title:{type:String,default:""},options:{type:Array,default:()=>[]},required:{type:Boolean,default:!1},value:{type:[String,Object,Number,Boolean],default:null},optionValue:{type:String,default:""},optionText:{type:String,default:""},error:{type:String,default:""},placeholder:{type:String,default:""},info:{type:String,default:""},disabled:{type:Boolean}},methods:{updateInput(){this.$emit("input",this.$refs.input.value),this.$emit("select",this.$refs.input.value)},getOptionValue(t){return this.optionValue?t[this.optionValue]:t},getOptionText(t){return this.optionText?t[this.optionText]:t}}},l=r,o=a("2877"),c=Object(o["a"])(l,s,i,!1,null,null,null);e["a"]=c.exports},"0f8e":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("FlexBox",{staticClass:"flex-lg-row flex-wrap align-items-lg-center",attrs:{direction:"column-reverse",justify:"between","align-items":"end"}},[a("Block",{staticClass:"p-2"},[t._v(" "+t._s(t.pagination.message)+" ")]),a("FlexBox",{staticClass:"flex-lg-row flex-wrap align-items-lg-center",attrs:{direction:"column",justify:"between","align-items":"end"}},[a("InputSelect",{staticClass:"my-2 my-lg-0",attrs:{options:t.perPages},on:{select:function(e){return t.$emit("change")}},model:{value:t.pagination.perPage,callback:function(e){t.$set(t.pagination,"perPage",e)},expression:"pagination.perPage"}}),a("nav",{staticClass:"ml-3"},[a("ul",{staticClass:"pagination disable-user-select mb-0"},[a("li",{staticClass:"page-item",class:{disabled:!t.isPreviousable},on:{click:function(e){return e.preventDefault(),t.setCurrent(t.current-1)}}},[a("span",{staticClass:"page-link"},[t._v("Previous")])]),t._l(t.pages,(function(e,s){return a("li",{key:s,staticClass:"page-item",class:{active:t.current===e}},[a("a",{staticClass:"page-link btn-primary",attrs:{href:"#"},on:{click:function(a){return a.preventDefault(),t.setCurrent(e)}}},[t._v(t._s(e))])])})),a("li",{staticClass:"page-item",class:{disabled:!t.isNextable},on:{click:function(e){return e.preventDefault(),t.setCurrent(t.current+1)}}},[a("a",{staticClass:"page-link",attrs:{href:"#"}},[t._v("Next")])])],2)])],1)],1)},i=[],n=a("2ef0"),r=a("9559"),l=a("0814"),o=a("0af5"),c={name:"Pagination",components:{InputSelect:o["a"],Block:l["a"],FlexBox:r["a"]},props:{visibleLength:{type:Number,default:5},pagination:{type:Object,default(){return{}}}},data(){return{offset:0,perPages:[5,15,25,50,100],pages:[]}},computed:{current(){return this.pagination.current||1},length(){return this.pagination.pages||1},isNextable(){return this.length>this.current},isPreviousable(){return this.current>1}},watch:{length:{handler(){this.unWatchCurrentPageValue();const{visibleLength:t}=this,e=Math.ceil(t/2)+(t%2?0:1);this.offset=t-(t-e+1),this.generatePagination(),this.length>this.visibleLength&&(this.unWatchCurrentPageValue=this.$watch("current",this.generatePagination))},immediate:!0}},methods:{unWatchCurrentPageValue(){},generatePagination(){const{current:t,offset:e,length:a,visibleLength:s}=this;let i=t-e;i<1&&(i=1);let r=i+s;r>a&&(r=a+1,i=r-s,i<1&&(i=1)),this.pages=Object(n["range"])(i,r)},setCurrent(t){let e=t;t<=1?e=1:t>=this.length&&(e=this.length),e!==this.current&&this.$emit("change",e)}}},u=c,d=(a("5148"),a("2877")),p=Object(d["a"])(u,s,i,!1,null,"64c09d8e",null);e["a"]=p.exports},"2a1d":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Block",[a("LowBalanceAlert",{staticClass:"mb-4"}),a("Row",[a("Column",{attrs:{lg:"6"}},[a("DashCard",{staticClass:"px-lg-5",attrs:{title:"Current Balance",icon:"database","is-loading":t.isFetchingBalance,remark:"Available"}},[a("h1",{staticClass:"text-currency text-3xl m-0"},[t._v(" "+t._s(t.currencyFormat(t.balanceMeta.amount))+" ")])])],1),a("Column",{attrs:{lg:"6"}},[a("DashCard",{staticClass:"px-lg-5",attrs:{title:"Estimated Credits",content:t.balanceMeta.credits,icon:"envelope","is-loading":t.isFetchingBalance,remark:"(Rs."+t.balanceMeta.rate+" per credit)"}})],1)],1),a("DepositsTable",{attrs:{"show-user":"SUPER_ADMIN"===t.role,deposits:t.deposits,"is-loading":t.isFetchingDeposits,pagination:t.pagination},on:{reload:t.fetchData}})],1)},i=[],n=(a("ddb0"),a("2f62")),r=a("0814"),l=a("e1778"),o=a("7228"),c=a("27dc"),u=a("1b32"),d=a("9197"),p=a("dbba"),h=a("337b"),g={name:"Balance",components:{LowBalanceAlert:h["a"],DashCard:p["a"],DepositsTable:d["a"],Column:u["a"],Row:c["a"],Block:r["a"]},data(){return{isLoading:!1,isFetchingBalance:!1,isFetchingDeposits:!1,balanceMeta:{amount:0,rate:0,credits:0},deposits:[],pagination:{pages:1,current:1,perPage:15}}},computed:{...Object(n["c"])(["role","user"])},created(){this.fetchData()},mounted(){this.$bus.on("router-link-clicked",()=>{this.isLoading||this.fetchData()})},beforeDestroy(){this.$bus.removeAllListeners("router-link-clicked")},methods:{fetchRevenues(){return this.isFetchingBalance=!0,Object(l["c"])().then(t=>{const{amount:e,rate:a,credits:s}=t;this.balanceMeta={amount:e,rate:a,credits:s}}).catch(t=>{this.$toast.error(t||"There was an error while fetching data.")}).finally(()=>{this.isFetchingBalance=!1})},fetchDeposits(){this.isFetchingDeposits=!0,Object(l["d"])({page:this.pagination.current||null,per_page:this.pagination.perPage}).then(({data:t,meta:e})=>{this.deposits=t,this.pagination=Object(o["b"])(e),this.isLoading=!1}).catch(t=>{"request-cancel"!==t&&this.$toast.error("There was an error while fetching data.")}).finally(()=>{this.isFetchingDeposits=!1})},fetchData(){this.isLoading=!0,Promise.all([this.fetchRevenues(),this.fetchDeposits()]).finally(()=>{this.isLoading=!1})},onBalanceDeposited(){this.fetchData()}}},f=g,m=a("2877"),b=Object(m["a"])(f,s,i,!1,null,"5e6e72e6",null);e["default"]=b.exports},5148:function(t,e,a){"use strict";a("b994")},9197:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Block",{staticClass:"mb-4"},[a("h5",[t._v("Deposits History")]),a("CardBase",{class:t.isLoading?"":"with-table"},[a("CardLoader",{attrs:{"is-loading":t.isLoading}},[a("Block",{staticClass:"table-responsive collapsible"},[t.deposits.length?a("table",{staticClass:"table m-0"},[a("thead",{staticClass:"bg-gray-lighter"},[a("tr",[a("th",{staticStyle:{width:"70px"}},[t._v(" # ")]),t.showUser?a("th",{staticClass:"pl-4 wrappable"},[t._v(" User ")]):t._e(),a("th",{staticStyle:{"min-width":"120px"}},[t._v(" Amount ")]),a("th",{staticStyle:{"min-width":"100px"}},[t._v(" Method ")]),a("th",{staticClass:"wrapable",staticStyle:{width:"20%"}},[t._v(" Description ")]),a("th",{staticStyle:{width:"100px"}},[t._v(" Status ")]),a("th",{staticClass:"text-right px-4",staticStyle:{"min-width":"120px"}},[t._v(" Date ")]),a("th",{staticClass:"text-right px-4",staticStyle:{"min-width":"120px"}},[t._v(" Created ")])])]),a("tbody",t._l(t.deposits,(function(e){return a("tr",{key:e.id,on:{click:function(a){return t.$emit("view",e.id)}}},[a("td",[a("span",{staticClass:"hidden-info"},[t._v("#")]),a("span",[t._v(t._s(e.id))])]),t.showUser?a("td",{staticClass:"pl-4"},[a("span",{staticClass:"hidden-info"},[t._v("User")]),a("span",{staticClass:"wrappable"},[t._v(t._s(e.display_name||"N/A"))])]):t._e(),a("td",[a("span",{staticClass:"hidden-info"},[t._v("Amount")]),a("span",{staticClass:"text-currency"},[t._v(t._s(t.currencyFormat(e.amount)))])]),a("td",[a("span",{staticClass:"hidden-info"},[t._v("Method")]),a("span",[t._v(t._s(e.payment_method))])]),a("td",{staticClass:"wrapable pr-5",staticStyle:{"max-width":"30%"}},[a("span",{staticClass:"hidden-info"},[t._v("Description")]),a("span",{staticClass:"description",attrs:{title:"CREATED"===e.status?e.description:e.remark}},[t._v(" "+t._s(("CREATED"===e.status?e.description:e.remark)||" N/A")+" ")])]),a("td",[a("span",{staticClass:"hidden-info"},[t._v("Status")]),a("span",{class:"VERIFIED"===e.status?"text-success":"CANCELLED"===e.status?"text-danger":""},[t._v(" "+t._s("CREATED"===e.status?"-":e.status)+" ")])]),a("td",{staticClass:"text-right px-4"},[a("span",{staticClass:"hidden-info"},[t._v("Date:")]),a("span",[t._v(t._s("CREATED"===e.status?"-":t.duration(e.status_date)))])]),a("td",{staticClass:"text-right px-4"},[a("span",{staticClass:"hidden-info"},[t._v("Created:")]),a("span",[t._v(t._s(t.duration(e.created_at)))])])])})),0)]):a("Block",{staticClass:"min-height-300 d-flex flex-row justify-content-center align-items-center"},[a("h4",{staticClass:"text-gray-dark font-w300"},[t._v(" Deposits not Found ")])])],1)],1)],1),a("Pagination",{staticClass:"my-2 my-lg-0",attrs:{pagination:t.pagination},on:{change:t.changePagination}})],1)},i=[],n=a("020b"),r=a("0f8e"),l=a("c2cd"),o=a("0814"),c={name:"DepositsTable",components:{Block:o["a"],CardBase:n["a"],Pagination:r["a"],CardLoader:l["a"]},props:{deposits:{type:Array,default(){return[]}},pagination:{type:Object,default(){return{}}},isLoading:{type:Boolean},showUser:{type:Boolean}},data(){return{}},methods:{changePagination(t){this.pagination.current=t,this.$emit("reload",t)}}},u=c,d=a("2877"),p=Object(d["a"])(u,s,i,!1,null,null,null);e["a"]=p.exports},b994:function(t,e,a){},dbba:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("CardBase",{staticClass:"p-4 block-sticky-options"},[a("CardLoader",{attrs:{"is-loading":t.isLoading}},[a("div",{staticClass:"block-options"},[a("div",{staticClass:"block-options-item"},[a("Icon",{staticClass:"fa-2x text-body-bg-dark",attrs:{type:t.iconType,name:t.icon}})],1)]),a("h5",{staticClass:"m-0"},[t._v(" "+t._s(t.title)+" ")]),t._t("default",[a("h1",{staticClass:"text-3xl m-0"},[t._v(" "+t._s(t.content)+" ")])]),a("span",[t._v(t._s(t.remark))])],2)],1)},i=[],n=a("020b"),r=a("5d35"),l=a("c2cd"),o={name:"DashCard",components:{CardLoader:l["a"],Icon:r["a"],CardBase:n["a"]},props:{title:{type:String,default:""},content:{type:[String,Number],default:""},remark:{type:String,default:""},color:{type:String,default:"primary"},icon:{type:String,default:""},iconType:{type:String,default:"fa"},isLoading:{type:Boolean}}},c=o,u=a("2877"),d=Object(u["a"])(c,s,i,!1,null,null,null);e["a"]=d.exports},e1778:function(t,e,a){"use strict";a.d(e,"d",(function(){return i})),a.d(e,"c",(function(){return n})),a.d(e,"a",(function(){return r})),a.d(e,"b",(function(){return l}));var s=a("9819");function i(t){const{cancelPrevious:e=!0}=t;return Object(s["a"])({url:"deposits",method:"get",params:t,cancelPrevious:e})}function n(t){return Object(s["a"])({url:"deposits/balance",method:"get",params:t})}function r(t){return Object(s["a"])({url:"deposits",method:"post",data:t})}function l(t){return Object(s["a"])({url:"deposits/aggregate",method:"get",params:t})}}}]);